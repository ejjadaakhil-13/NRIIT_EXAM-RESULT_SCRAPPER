<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NRIIT Exam Results Portal</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-color: #1a3a6c;
        --secondary-color: #e9ecef;
        --accent-color: #3d7dd4;
        --success-color: #147a58;
        --danger-color: #c9302c;
        --text-color: #2c3e50;
        --light-bg: #f8f9fa;
      }

      body {
        font-family: "Segoe UI", system-ui, sans-serif;
        color: var(--text-color);
        background-color: var(--light-bg);
        line-height: 1.6;
      }

      .page-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem 1rem;
      }

      .header {
        background-color: var(--primary-color);
        padding: 1.5rem;
        border-radius: 0.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      }

      .header h1 {
        color: white;
        font-weight: 600;
        margin-bottom: 0.5rem;
        font-size: 1.75rem;
      }

      .header p {
        color: rgba(255, 255, 255, 0.85);
        margin-bottom: 0;
        font-size: 1rem;
      }

      .card {
        border: none;
        border-radius: 0.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        margin-bottom: 1.5rem;
      }

      .card-header {
        background-color: white;
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        padding: 1rem 1.25rem;
        font-weight: 600;
      }

      .form-container .card-body {
        padding: 1.5rem;
      }

      .form-label {
        font-weight: 500;
        color: var(--text-color);
      }

      /* Updated button styles */
      .search-button {
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 4px;
        padding: 0.5rem 1.25rem;
        font-weight: 500;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .search-button:hover {
        background-color: #0f2952;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }

      .search-button:active {
        transform: translateY(0);
        box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
      }

      .search-button svg {
        width: 16px;
        height: 16px;
      }

      /* End updated button styles */

      .student-info {
        background-color: white;
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      .student-name {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--primary-color);
        margin-bottom: 0.25rem;
      }

      .roll-number {
        font-size: 1rem;
        color: #6c757d;
      }

      .semester-container {
        margin-bottom: 2rem;
      }

      .semester-heading {
        background-color: var(--primary-color);
        color: white;
        padding: 0.75rem 1.25rem;
        border-radius: 0.5rem;
        margin-bottom: 1rem;
        font-weight: 500;
        font-size: 1.1rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .semester-heading h3 {
        margin-bottom: 0;
        font-size: 1.1rem;
        font-weight: 500;
      }

      .result-card {
        background-color: white;
        border-radius: 0.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        padding: 1.25rem;
        height: 100%;
        transition: all 0.2s ease;
        border-top: 3px solid var(--accent-color);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }

      .subject-name {
        font-weight: 500;
        margin-bottom: 1rem;
        color: var(--text-color);
        min-height: 40px;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .status-badge {
        padding: 0.35rem 0.75rem;
        border-radius: 2rem;
        font-size: 0.85rem;
        font-weight: 500;
        display: inline-block;
        text-align: center;
      }

      .pass {
        background-color: rgba(20, 122, 88, 0.1);
        color: var(--success-color);
      }

      .fail {
        background-color: rgba(201, 48, 44, 0.1);
        color: var(--danger-color);
      }

      .loading {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 2rem;
        background-color: white;
        border-radius: 0.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      .loading p {
        margin-top: 1rem;
        color: var(--text-color);
      }

      /* Empty state */
      .empty-state {
        background-color: white;
        border-radius: 0.5rem;
        padding: 3rem 1rem;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        margin-bottom: 2rem;
      }

      .empty-state svg {
        width: 60px;
        height: 60px;
        color: #d1d5db;
        margin-bottom: 1rem;
      }

      .empty-state h3 {
        font-size: 1.25rem;
        color: var(--text-color);
        margin-bottom: 0.5rem;
      }

      .empty-state p {
        color: #6c757d;
        max-width: 500px;
        margin: 0 auto;
      }

      footer {
        text-align: center;
        margin-top: 3rem;
        padding: 1.5rem;
        background-color: white;
        border-radius: 0.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        color: #6c757d;
        font-size: 0.875rem;
      }

      /* Results summary */
      .results-summary {
        background-color: white;
        border-radius: 0.5rem;
        padding: 1rem 1.5rem;
        margin-bottom: 2rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        border-left: 4px solid var(--accent-color);
      }

      .summary-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 0.75rem;
      }

      .summary-stats {
        display: flex;
        gap: 1.5rem;
        flex-wrap: wrap;
      }

      .stat-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .stat-value {
        font-weight: 600;
        font-size: 1.125rem;
      }

      .stat-label {
        color: #6c757d;
        font-size: 0.875rem;
      }

      /* Failed subjects highlight */
      .failed-subjects {
        margin-top: 0.5rem;
        color: var(--danger-color);
        font-weight: 500;
        font-size: 0.95rem;
      }

      @media (max-width: 768px) {
        .result-card {
          margin-bottom: 1rem;
        }

        .student-info {
          padding: 1rem;
        }

        .header {
          padding: 1rem;
        }

        .header h1 {
          font-size: 1.5rem;
        }

        .summary-stats {
          flex-direction: column;
          gap: 0.75rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="page-container">
      <div class="header">
        <h1>NRIIT Academic Results Portal</h1>
        <p>Consolidated semester results viewer</p>
      </div>

      <div class="card form-container">
        <div class="card-header">Student Information</div>
        <div class="card-body">
          <form method="POST" action="/">
            <div class="mb-3">
              <label for="roll_number" class="form-label">Roll Number</label>
              <div class="input-group">
                <input
                  type="text"
                  class="form-control"
                  id="roll_number"
                  name="roll_number"
                  placeholder="e.g., 20KN1AXXXX"
                  value="{{ roll_number }}"
                  required
                />
                <button type="submit" class="search-button" id="submitBtn">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                  </svg>
                  Search
                </button>
              </div>
              <div class="form-text text-muted mt-2">
                Enter your roll number in the format: 20KN1A0XXXX
              </div>
            </div>
          </form>
        </div>
      </div>

      <div id="loadingIndicator" class="loading d-none">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p>Fetching results, please wait...</p>
      </div>

      {% if not has_any_results and not roll_number %}
      <div class="empty-state">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
          />
        </svg>
        <h3>No Results Displayed</h3>
        <p>Enter your roll number above to view your academic results.</p>
      </div>
      {% endif %} {% if student_info %}
      <div class="student-info">
        <div class="row align-items-center">
          <div class="col-md-6">
            <div class="student-name">
              {{ student_info.get('name', 'Student') }}
            </div>
            <div class="roll-number">Roll No: {{ roll_number }}</div>
            {% if failed_subjects_count > 0 %}
            <div class="failed-subjects">
              <i class="bi bi-exclamation-triangle"></i>
              {{ failed_subjects_count }} Failed subject{% if
              failed_subjects_count != 1 %}s{% endif %} remaining
            </div>
            {% endif %}
          </div>
          <div class="col-md-6 text-md-end">
            <div class="text-muted">
              Report generated: {{ now().strftime('%B %d, %Y') }}
            </div>
          </div>
        </div>
      </div>

      {% if result %} {% set has_results = false %} {% set total_subjects = 0 %}
      {% set passed_subjects = 0 %} {# Count total and passed subjects #} {% for
      semester, subjects in result.items() %} {% if subjects %} {% for subject,
      status in subjects.items() %} {% set total_subjects = total_subjects + 1
      %} {% if status.lower() == 'pass' %} {% set passed_subjects =
      passed_subjects + 1 %} {% endif %} {% endfor %} {% endif %} {% endfor %}
      {% if total_subjects > 0 %}
      <div class="results-summary">
        <div class="summary-title">Results Overview</div>
        <div class="summary-stats">
          <div class="stat-item">
            <div class="stat-value">{{ total_subjects }}</div>
            <div class="stat-label">Total Subjects</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">{{ passed_subjects }}</div>
            <div class="stat-label">Subjects Passed</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">{{ failed_subjects_count }}</div>
            <div class="stat-label">Subjects Failed</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">
              {{ (passed_subjects / total_subjects * 100) | round }}%
            </div>
            <div class="stat-label">Success Rate</div>
          </div>
        </div>
      </div>
      {% endif %} {% endif %} {% endif %}

      <div class="results-container">
        {% if result %} {% set has_results = false %} {% for semester, subjects
        in result.items() %} {% if subjects %} {% set has_results = true %}
        <div class="semester-container">
          <div class="semester-heading">
            <h3>{{ semester_names.get(semester, semester) }}</h3>
          </div>

          <div class="row g-3">
            {% for subject, status in subjects.items() %}
            <div class="col-lg-4 col-md-6 mb-3">
              <div class="result-card">
                <div class="subject-name">{{ subject }}</div>
                <div
                  class="status-badge {{ 'pass' if status.lower() == 'pass' else 'fail' if status.lower() == 'fail' else '' }}"
                >
                  {{ status }}
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
        {% endif %} {% endfor %}

        <!-- Removed the "No results found" message -->

        {% endif %}
      </div>

      <footer>
        <p>&copy; 2025 NRIIT Results Portal | Authorized access only</p>
      </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.querySelector("form");
        const loadingIndicator = document.getElementById("loadingIndicator");

        form.addEventListener("submit", function () {
          loadingIndicator.classList.remove("d-none");
        });
      });
    </script>
  </body>
</html>
